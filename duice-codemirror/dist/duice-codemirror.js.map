{"version":3,"file":"duice-codemirror.js","sources":["../../../duice/dist/event/DataEvent.js","../../../duice/dist/event/PropertyChangeEvent.js","Codemirror.js","CodemirrorFactory.js"],"sourcesContent":["export class DataEvent {\n    constructor(source) {\n        this.source = source;\n    }\n}\n//# sourceMappingURL=DataEvent.js.map","import { DataEvent } from \"./DataEvent\";\nexport class PropertyChangeEvent extends DataEvent {\n    constructor(source, property, value, index) {\n        super(source);\n        this.property = property;\n        this.value = value;\n        this.index = index;\n    }\n    getProperty() {\n        return this.property;\n    }\n    getValue() {\n        return this.value;\n    }\n    getIndex() {\n        return this.index;\n    }\n}\n//# sourceMappingURL=PropertyChangeEvent.js.map","import { getElementAttribute, ObjectElement } from \"duice\";\nimport { PropertyChangeEvent } from \"../../../duice/dist/event/PropertyChangeEvent\";\nexport class Codemirror extends ObjectElement {\n    constructor(element, bindData, context) {\n        super(element, bindData, context);\n        this.mode = 'text/x-markdown';\n        this.theme = 'default';\n        this.getHtmlElement().style.display = 'block';\n        // option\n        this.mode = getElementAttribute(element, 'mode') || this.mode;\n        this.theme = getElementAttribute(element, 'theme') || this.theme;\n        // config\n        let config = {\n            mode: this.mode,\n            inputStyle: 'textarea',\n            lineNumbers: true,\n            theme: this.theme,\n            extraKeys: { \"Enter\": \"newlineAndIndentContinueMarkdownList\" }\n        };\n        // textarea\n        let textarea = document.createElement('textarea');\n        this.getHtmlElement().appendChild(textarea);\n        // create code mirror\n        this.codeMirror = CodeMirror.fromTextArea(textarea, config);\n        this.codeMirror.setSize('100%', '100%');\n        // refresh (not working without setTimeout)\n        setTimeout(() => {\n            this.codeMirror.refresh();\n        }, 1);\n        // add change event listener\n        this.codeMirror.on(\"blur\", () => {\n            let event = new PropertyChangeEvent(this, this.getProperty(), this.getValue(), this.getIndex());\n            this.notifyObservers(event);\n        });\n    }\n    setValue(value) {\n        if (!value) {\n            value = '';\n        }\n        let scrollInfo = this.codeMirror.getScrollInfo();\n        this.codeMirror.doc.setValue(value);\n        this.codeMirror.scrollTo(scrollInfo.left, scrollInfo.top);\n    }\n    getValue() {\n        let value = this.codeMirror.doc.getValue();\n        if (!value) {\n            return null;\n        }\n        return value;\n    }\n    setReadonly(readonly) {\n        this.codeMirror.setOption('readOnly', readonly);\n    }\n}\n//# sourceMappingURL=Codemirror.js.map","import { Configuration, DataElementRegistry, ObjectElementFactory } from \"duice\";\nimport { Codemirror } from \"./Codemirror\";\nexport class CodemirrorFactory extends ObjectElementFactory {\n    createElement(htmlElement, bindData, context) {\n        return new Codemirror(htmlElement, bindData, context);\n    }\n}\n(() => {\n    // register\n    DataElementRegistry.register(`${Configuration.getNamespace()}-codemirror`, new CodemirrorFactory());\n})();\n//# sourceMappingURL=CodemirrorFactory.js.map"],"names":["ObjectElement","getElementAttribute","ObjectElementFactory","DataElementRegistry","Configuration"],"mappings":"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"}