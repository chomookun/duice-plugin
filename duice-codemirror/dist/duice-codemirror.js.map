{"version":3,"file":"duice-codemirror.js","sources":["CodemirrorElement.js","CodemirrorElementFactory.js"],"sourcesContent":["import { getElementAttribute, ObjectElement } from \"duice\";\nimport { PropertyChangingEvent } from \"duice\";\n/**\n * Codemirror Element\n */\nexport class CodemirrorElement extends ObjectElement {\n    /**\n     * Constructor\n     * @param htmlElement html element\n     * @param bindData bind data\n     * @param context context\n     */\n    constructor(htmlElement, bindData, context) {\n        super(htmlElement, bindData, context);\n        this.mode = 'text/x-markdown';\n        this.theme = 'default';\n        this.getHtmlElement().style.display = 'block';\n        // option\n        this.mode = getElementAttribute(htmlElement, 'mode') || this.mode;\n        this.theme = getElementAttribute(htmlElement, 'theme') || this.theme;\n        // config\n        let config = {\n            mode: this.mode,\n            inputStyle: 'textarea',\n            lineNumbers: true,\n            theme: this.theme,\n            extraKeys: { \"Enter\": \"newlineAndIndentContinueMarkdownList\" }\n        };\n        // textarea\n        let textarea = document.createElement('textarea');\n        this.getHtmlElement().appendChild(textarea);\n        // create code mirror\n        this.codeMirror = CodeMirror.fromTextArea(textarea, config);\n        this.codeMirror.setSize('100%', '100%');\n        // refresh (not working without setTimeout)\n        setTimeout(() => {\n            this.codeMirror.refresh();\n        }, 1);\n        // add change event listener\n        this.codeMirror.on(\"blur\", () => {\n            let element = this.getHtmlElement();\n            let data = this.getBindData();\n            let event = new PropertyChangingEvent(element, data, this.getProperty(), this.getValue(), this.getIndex());\n            this.notifyObservers(event);\n        });\n    }\n    /**\n     * Sets value\n     * @param value property value\n     */\n    setValue(value) {\n        if (!value) {\n            value = '';\n        }\n        let scrollInfo = this.codeMirror.getScrollInfo();\n        this.codeMirror.doc.setValue(value);\n        this.codeMirror.scrollTo(scrollInfo.left, scrollInfo.top);\n    }\n    /**\n     * Gets value\n     */\n    getValue() {\n        let value = this.codeMirror.doc.getValue();\n        if (!value) {\n            return null;\n        }\n        return value;\n    }\n    /**\n     * Sets readonly\n     * @param readonly readonly or not\n     */\n    setReadonly(readonly) {\n        this.codeMirror.setOption('readOnly', readonly);\n    }\n}\n//# sourceMappingURL=CodemirrorElement.js.map","import { Configuration, ElementRegistry, ObjectElementFactory } from \"duice\";\nimport { CodemirrorElement } from \"./CodemirrorElement\";\n/**\n * Codemirror Factory\n */\nexport class CodemirrorElementFactory extends ObjectElementFactory {\n    /**\n     * Creates element\n     * @param htmlElement html element\n     * @param bindData bind data\n     * @param context context\n     */\n    createElement(htmlElement, bindData, context) {\n        return new CodemirrorElement(htmlElement, bindData, context);\n    }\n}\n/**\n * Static block\n */\n(() => {\n    // register\n    ElementRegistry.register(`${Configuration.getNamespace()}-codemirror`, new CodemirrorElementFactory());\n})();\n//# sourceMappingURL=CodemirrorElementFactory.js.map"],"names":["ObjectElement","getElementAttribute","PropertyChangingEvent","ObjectElementFactory","ElementRegistry","Configuration"],"mappings":"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"}